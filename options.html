<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="screen" type="text/css" href="lib/colorpicker/css/colorpicker.css" />
  <script type="text/javascript" src="lib/colorpicker/js/jquery.js"></script>
  <script type="text/javascript" src="lib/colorpicker/js/colorpicker.js"></script>
</head>
<body>
  針
  <p id="hand-color" style="width:400px;height:200px"></p>
  背景
  <p id="bg-color" style="width:400px;height:200px"></p>
<script type="text/javascript">
'use strict';

chrome.storage.local.get("conf", function(items){
  var conf = {
    "hand": {
      "color": {"r": 0, "g": 0, "b": 0}
    },
    "background": {
      "shape": "square",
      "color": {"r":0,"g":0,"b":0}
    }
  };

  try {
    conf = JSON.parse(items["conf"]);
  } catch(e) {}

  $('#hand-color').ColorPicker({
    color: conf["hand"]["color"],
    flat: true,
    onChange: function (hsb, hex, rgb) {
      conf["hand"]["color"] = rgb;
      chrome.storage.local.set({"conf": JSON.stringify(conf)});
	   }
   });

  $('#bg-color').ColorPicker({
     color: conf["background"]["color"],
     flat: true,
     onChange: function (hsb, hex, rgb) {
       conf["background"]["color"] = rgb;
       chrome.storage.local.set({"conf": JSON.stringify(conf)});
     }
    });
 });
</script>
</body>
</html>
